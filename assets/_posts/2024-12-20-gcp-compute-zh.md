---
layout: post  
title: "设置 Google Cloud 服务器"
audio: true
---

在 Google Cloud 中设置代理服务器可以让你通过云实例安全地路由互联网流量，增强隐私性并绕过网络限制。在本指南中，我们将带您完成在 Google Cloud 中设置基本代理服务器的过程，并配置必要的防火墙规则以允许流量。

## 目录
1. [创建 Google Cloud VM 实例](#创建-google-cloud-vm-实例)
2. [配置代理服务器](#配置代理服务器)
3. [设置防火墙规则](#设置防火墙规则)
4. [测试代理服务器](#测试代理服务器)
5. [总结](#总结)

---

## 创建 Google Cloud VM 实例

在设置代理服务器之前，您需要在 Google Cloud 中创建一个虚拟机（VM）实例。

1. 登录到 Google Cloud 控制台： 访问 [Google Cloud 控制台](https://console.cloud.google.com/) 并登录您的帐户。
   
2. 创建新 VM 实例：
   - 导航到 计算引擎 > VM 实例。
   - 点击 创建实例。
   - 选择所需的 区域 和 机器类型。为了简单起见，您可以使用默认设置或选择像 `e2-micro` 这样的轻量配置。
   - 在 防火墙 部分，选择 允许 HTTP 流量 和 允许 HTTPS 流量 以启用 Web 访问。
   
3. 设置 SSH 访问：
   - 在 SSH 密钥 部分，将您的 SSH 公钥添加到实例中，以便您稍后进行远程访问。这对于配置代理服务器至关重要。
   
4. 点击创建 以启动您的 VM。

实例创建完成后，您可以使用以下命令通过 Google Cloud 控制台或终端连接到实例：

```bash
gcloud compute ssh <您的-vm名称>
```

---

## 配置代理服务器

一旦您的虚拟机设置完毕，您可以配置所选的任何代理服务器软件。代理服务器软件应该安装并配置为在所需的端口上接受连接（例如，常见的代理端口是 `3128`）。确保软件允许来自远程客户端的连接。

---

## 设置防火墙规则

为了允许流量通过您的代理服务器，您需要配置 Google Cloud 防火墙规则以开放所需的端口。

1. 导航到 Google Cloud 控制台中的防火墙规则：
   - 进入 VPC 网络 > 防火墙规则。

2. 创建新的防火墙规则：
   - 点击 创建防火墙规则。
   - 为规则命名，例如 `allow-proxy-access`。
   - 将 流量方向 设置为 Ingress（传入流量）。
   - 将 匹配时的操作 设置为 允许。
   - 设置 目标 为 网络中的所有实例 或 指定目标标签（如果您想要更好的控制）。
   - 在 源 IP 范围 部分，您可以设置为 `0.0.0.0/0`，允许所有 IP 地址的访问，或者根据需要限制为特定的 IP 地址或范围，以提高安全性。
   - 在 协议和端口 部分，选择 指定协议和端口，并输入您的代理服务器所使用的端口（例如，`tcp:3128`）。

3. 保存防火墙规则：
   配置规则后，点击 创建 以启用该防火墙规则。

---

## 测试代理服务器

配置防火墙规则后，接下来是测试您的代理服务器。

1. 从本地机器测试代理：

   您可以配置本地机器的浏览器或系统代理设置，使用您的 Google Cloud VM 的外部 IP 地址和代理服务器监听的端口（例如，`3128`）。

2. 使用命令行测试：
   
   您还可以通过设置代理环境变量来测试代理服务器：

```bash
export http_proxy=http://<您的-vm-外部-ip>:3128
export https_proxy=http://<您的-vm-外部-ip>:3128
curl -I http://example.com
```

如果连接成功，您应该会看到来自网站的响应。

---

## 总结

通过遵循本指南，您已经学会了如何在 Google Cloud 中设置代理服务器，并配置防火墙规则以允许传入流量。此设置为您提供了一个轻松的方式，可以通过云服务器安全地路由互联网流量，绕过网络限制并增强隐私性。

